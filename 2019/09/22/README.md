# 2019.09.22

本周做为试行周，给自己定了适当的几个 *To-Do* 项目。但是由于课程还是比较繁忙的，因此仍有部分内容未完成。

## 课堂内容

首先，记录一下在课堂上学习的**操作系统**内容：

操作系统课程由于课程冲突（一周两节，有一节冲突）的原因，我没有选，但是由于主讲老师讲的太好了，因此还是每周都去蹭不冲突的那节课。

本节课讲解的是对**进程 0** 的初始化过程。*操作系统的本质实际上就是一堆进程的调用和分配*，对于进程 0，相比于其他进程不同的地方是其他进程都是通过父进程创建出来的，而进程 0 是在内核初始化阶段由内核编写人员直接静态写入的，同时其相关的进程结构 `task_struct` 存储在内核数据段中。这里与进程相关的比较重要的两个数据结构是 `tdl` 与 `tss`，每个进程都有对应的 `tdl` 和 `tss` 字段，这两个字段主要是为了标识出与当前 CPU 正在执行的进程相关的一些信息（`tdl` 则存放了数据段、代码段的段描述符，`tss` 则记录了对应进程的各寄存器的值），因此现在来看，这两个数据结构与进程调度有不可分的关系。在完成创建进程 0 之后，内核还模拟了硬件中断，将相应的数据压入栈中，并调用 `iret` 指令，完成进程 0 从 0 特权级向 3 特权级的跳转（在跳转之前内核代码还开启了中断），至此才算完成了进程 0 的创建。

由于有一节课没法去上，因此课后自行学习了后续的部分内容——创建进程 1。创建进程 1 的过程涉及到系统调用（fork()），而系统调用（int 80）中断在创建进程 0 的时候已经开启，并将其与系统调用处理函数进行了绑定，因此在系统调用处理函数中根据系统调用编号（也是由内核决定，写在内核的代码中）调用相应的系统调用处理程序（实际上就是一个函数数组，根据系统调用编号选中相应的数组项调用）。之后由于 `fork` 子进程的需要，涉及到一系列的压栈操作，并通过复制父进程本身，来为子进程分配内存控件以及初始化子进程的页表。（这个时候除了一些标识进程的字段不同，大部分字段都是直接复制的父进程的内容）

之后是**计算机体系结构**的课程，本节课主要讲解了计算机中数的表示形式（定点、浮点），CMOS 电路的基本结构（P 管和 N 管）以及大体制造过程，以及集成电路的版图，并结合版图、逻辑表达式讲解了逻辑电路图的绘制。此外，还讲解了组合逻辑电路以及时序逻辑电路，并讲解了时序逻辑电路中触发器的一些基本概念和时延的计算。最后讲解了 Verilog 语言的基本使用。总的来说，由于本科期间的数字电路知识大致淡忘了，一节课的内容还是比较多的，需要点时间进行消化。

在 **Web 安全技术**课堂上，主要了解了口令泄漏的一些事件以及使用 Cookie 作为认证令牌的一些安全隐患，此外还讲解了 OWASP 2017 年 Top 10 安全隐患。

在**算法**课堂上，主要讲解了分治的思想，需要根据输入来进行确定子问题的划分，该怎么分，如何分，以及通过输出来确定子问题的解该怎么合并。同时，老师使用了**归并排序**讲解了基于数组下标来划分子问题的方法以及**快速排序**讲解了基于数组大小来划分子问题的两种方式，并分别讲解了划分之后的基本时间复杂度的简单求法（这一块涉及到较多公式，自己也没去细推）。

此外，还有一些研讨课、非专业课以及与安全方面相关不大的专业课，暂不列举。

## 课后内容

本周首先完成了工程上的一些基本任务，找到 Linux 系统中的 3 个堆相关的软件漏洞。

根据学到的操作系统的基本理论知识，并参阅一些汇编相关知识，实现了通过 QEMU 加载一个仅占一个扇区的简单二进制程序（可以理解为操作系统的胚胎？），并借助 BIOS 中断输出一行文字，同时借助 BIOS 中断加载后面扇区内容。*因此下周想尝试能否继续完善此二进制程序，实现从 16-bit 实模式到保护模式的转换，但是感觉对保护模式下的各个中断程序的实现有点不太现实，到时候看看再说。*

然后，断断续续用了较多时间，看完了 Phrack Magazine 中的一篇[关于 V8 引擎中的漏洞分析的文章](https://github.com/lcyfrank/Week/blob/master/2019/09/22/V8.md)，读完文章之后对 V8 引擎有了一些大致的了解，但是对文章中提到的浏览器中常出现的 Type Confusion 漏洞还是没有清晰且直观的印象。*因此下周对 Type Confusion 漏洞好好了解一下，然后在国庆期间对 V8 引擎有个更深入的了解。*

然后，看了一篇[真实的漏洞分析](http://blogs.360.cn/post/When-GC-Triggers-Callback.html)（虽然原计划是看 5 篇），比较巧的是也是浏览器（Internet Explore）脚本语言解析引擎中的漏洞，也是利用了 Type Confusion 的错误，其涉及到 VBScript 和 JavaScript 两种语言同时配合从而触发相应的错误。*但是仍然由于对 Type Confusion 的不了解没有完全弄懂。*

然后，继续阅读 Fuzzing 相关的书中的内容两章，主要涉及到文件格式的 Fuzzing 问题。但是感觉文件格式 Fuzzing 的方法基本与之前看的命令行参数与环境变量 Fuzzing 的问题类似，都是基于本地程序进行 Fuzzing 操作，不同的地方是文件格式 Fuzzing 设计到文件的变换/根据格式产生，可能在这一块比较复杂。此外，由于文件格式 Fuzzing 不涉及到对参数的 Fuzzing 问题，因此在启动目标程序时，需要提供正确的启动参数。同时，Fuzzing 过程中主要的问题是对错误/异常的监视，这里使用的方法是：Linux 中通过 ptrace 来监视程序执行状态；Windows 中借助调试器 API 将相应的调试器集成自 Fuzzing 程序中，从而对错误进行监视。

最后，看了一章 Web 安全书中的内容，主要讲了 Session 管理的安全问题。针对 Session 管理的攻击，主要还是依靠对令牌（Token）的破解，而对于令牌的破解，有猜测令牌生成规则以及通过其他手段获得受害者的令牌这两种方式。因此在日常 Web 开发中需要对令牌的生成规则做到足够随机化，并且对令牌的管理要有时间限制，以及对每个令牌赋予特有的权限。

## 总结

以上就是本周大体的学习内容。关于书本的笔记由于内容较多，因此不上传至仓库中，只在本地记录。

本周由于课程作业较多，以及自己的一些事情，完成的计划内容较少。此外，发现自己在课后内容的学习过程中效率较低。

本周所定的计划中以及完成的计划中，对基本知识的侧重点较多，而对于论文以及相关方面前卫分析文章的阅读较少，下周需要在这些方面有所涉猎，而且对自己的学习效率需要有更合理的管理。
